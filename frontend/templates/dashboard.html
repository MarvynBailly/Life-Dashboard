{% extends "base.html" %}

{% block content %}
<div class="dashboard-grid">

    <!-- Row 1: Coding Activity Charts -->
    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">‚è±Ô∏è</span>
                Coding Activity
            </div>
            <span class="card-subtitle">Last 7 days</span>
        </div>
        <div class="card-body">
            <div class="chart-container large" id="chart-coding-activity"></div>
        </div>
    </div>

    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìÖ</span>
                Today's Breakdown
            </div>
            <span class="card-subtitle" id="today-total">0 hrs 0 mins</span>
        </div>
        <div class="card-body">
            <div class="timeline-container" id="today-timeline">
                <div class="timeline-header">
                    <div class="timeline-axis">
                        <span>12a</span><span>3a</span><span>6a</span><span>9a</span>
                        <span>12p</span><span>3p</span><span>6p</span><span>9p</span><span>12a</span>
                    </div>
                </div>
                <div class="timeline-rows" id="timeline-rows">
                    <div class="timeline-empty">No coding activity yet today</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Row 2: Projects & Languages -->
    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìÅ</span>
                Projects
            </div>
        </div>
        <div class="card-body">
            <div class="chart-container" id="chart-projects"></div>
            <ul class="stats-list mt-md" id="projects-list"></ul>
        </div>
    </div>

    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üíª</span>
                Languages
            </div>
        </div>
        <div class="card-body">
            <div class="chart-container" id="chart-languages"></div>
            <ul class="stats-list mt-md" id="languages-list"></ul>
        </div>
    </div>

    <!-- Row 3: Editors & OS -->
    <div class="card card-third">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìù</span>
                Editors
            </div>
        </div>
        <div class="card-body">
            <div class="chart-container small" id="chart-editors"></div>
        </div>
    </div>

    <div class="card card-third">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üñ•Ô∏è</span>
                Operating Systems
            </div>
        </div>
        <div class="card-body">
            <div class="chart-container small" id="chart-os"></div>
        </div>
    </div>

    <div class="card card-third">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìä</span>
                Weekly Activity
            </div>
        </div>
        <div class="card-body">
            <div class="heatmap-container" id="weekly-heatmap">
                <!-- Heatmap will be generated here -->
            </div>
        </div>
    </div>

    <!-- Row 3.5: ActivityWatch App Usage -->
    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üëÅÔ∏è</span>
                App Usage
            </div>
            <span class="card-subtitle">Last 24 hours</span>
        </div>
        <div class="card-body">
            <div class="chart-container" id="chart-app-usage"></div>
            <ul class="stats-list mt-md" id="app-usage-list"></ul>
        </div>
    </div>

    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">‚è∞</span>
                Screen Time
            </div>
            <span class="card-subtitle" id="aw-active-time">--</span>
        </div>
        <div class="card-body">
            <div class="screen-time-stats">
                <div class="screen-time-item">
                    <div class="screen-time-label">Active Time</div>
                    <div class="screen-time-value text-success" id="aw-active-display">--</div>
                </div>
                <div class="screen-time-item">
                    <div class="screen-time-label">Away (AFK)</div>
                    <div class="screen-time-value text-warning" id="aw-afk-display">--</div>
                </div>
            </div>
            <div class="screen-time-bar mt-md">
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="aw-active-bar" style="width: 0%; background-color: var(--accent-green);"></div>
                </div>
                <div class="screen-time-legend mt-sm">
                    <span class="legend-item"><span class="legend-dot" style="background: var(--accent-green);"></span> Active</span>
                    <span class="legend-item"><span class="legend-dot" style="background: var(--accent-yellow);"></span> AFK</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Row 3.75: GitHub -->
    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">&#128025;</span>
                GitHub Repos
            </div>
            <span class="card-subtitle">Recently updated</span>
        </div>
        <div class="card-body">
            <div id="chart-github-repos"></div>
        </div>
    </div>

    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">&#128200;</span>
                GitHub Contributions
            </div>
            <span class="card-subtitle" id="github-total-commits">0 commits</span>
        </div>
        <div class="card-body">
            <div class="chart-container large" id="chart-github-contributions"></div>
        </div>
    </div>

    <!-- Row 4: Music & Todos -->
    <div class="card card-third">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üéµ</span>
                Now Playing
            </div>
            <div class="playing-indicator" id="playing-indicator" style="display: none;">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
        </div>
        <div class="card-body">
            <div class="now-playing" id="now-playing">
                <img class="album-art" id="album-art" src="" alt="Album Art">
                <div class="track-info">
                    <div class="track-title" id="track-title">Not Playing</div>
                    <div class="track-artist" id="track-artist">--</div>
                    <div class="track-album" id="track-album"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="card card-two-thirds">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">‚úÖ</span>
                Active Tasks
            </div>
            <span class="card-subtitle" id="todo-count">0 tasks</span>
        </div>
        <div class="card-body">
            <ul class="todo-list" id="todo-list">
                <!-- Todos will be loaded here -->
            </ul>
            <div class="todo-input-container">
                <input type="text" class="todo-input" id="todo-input" placeholder="Add a new task...">
                <button class="btn btn-primary" id="add-todo-btn">Add</button>
            </div>
        </div>
    </div>

    <!-- Row 5: Notes & Journal -->
    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìù</span>
                Recent Notes
            </div>
            <button class="btn btn-secondary btn-icon" id="add-note-btn" title="Add Note">+</button>
        </div>
        <div class="card-body">
            <div class="notes-list" id="notes-list">
                <!-- Notes will be loaded here -->
            </div>
        </div>
    </div>

    <div class="card card-half">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üìî</span>
                Journal
                <span class="journal-streak-badge" id="journal-streak-badge" title="Day Streak">üî• <span id="journal-streak-display">0</span></span>
            </div>
            <div class="journal-header-actions">
                <div class="journal-today-indicator" id="journal-today-indicator" style="display: none;">
                    <span class="indicator-dot warning"></span>
                    <span>No entry today</span>
                </div>
                <button class="btn btn-primary btn-sm" id="write-journal-btn" title="Write Today's Entry">+ Write</button>
            </div>
        </div>
        <div class="card-body">
            <div class="journal-list" id="journal-list">
                <!-- Journal entries will be loaded here -->
            </div>
        </div>
    </div>

    <div class="card card-quarter">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üí≠</span>
                Daily Quote
            </div>
            <button class="btn btn-secondary btn-icon" id="refresh-quote-btn" title="New Quote">üîÑ</button>
        </div>
        <div class="card-body">
            <div class="quote-container" id="quote-container">
                <div class="quote-text" id="quote-text">Loading...</div>
                <div class="quote-author" id="quote-author"></div>
            </div>
        </div>
    </div>

    <!-- Row 6: Top Artists -->
    <div class="card card-full">
        <div class="card-header">
            <div class="card-title">
                <span class="icon">üé§</span>
                Top Artists
            </div>
            <span class="card-subtitle">Last 7 days</span>
        </div>
        <div class="card-body">
            <div class="chart-container" id="chart-top-artists"></div>
        </div>
    </div>

</div>
{% endblock %}

{% block scripts %}
<script>
    // Initialize dashboard when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        initDashboard();
    });
</script>
{% endblock %}
